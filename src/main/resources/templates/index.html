<html data-bs-theme="light" lang="en">

<head>
    <meta charset="utf-8">
    <meta content="width=device-width, initial-scale=1" name="viewport">
    <title>Ha-rmony</title>

    <link href="https://getbootstrap.kr/docs/5.3/examples/album/" rel="canonical">

    <link crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0/dist/css/bootstrap.min.css"
          integrity="sha384-gH2yIJqKdNHPEq0n4Mqa/HGKIhSkIHeL5AyhkYV8i59U5AR6csBvApHHNl/vI1Bx" rel="stylesheet">
    <script crossorigin="anonymous" integrity="sha384-A3rJD856KowSb7dwlZdYEkO39Gagi7vIsF0jrRAoQmDKKtQBHUuLZ9AsSv4jD4Xa"
            src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0/dist/js/bootstrap.bundle.min.js">
    </script>
    <script crossorigin="anonymous"
            integrity="sha256-2Pmvv0kuTBOenSvLm6bvfBSSHrUJ+3A7x6P5Ebd07/g="
            src="https://code.jquery.com/jquery-3.7.0.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/js-cookie@3.0.5/dist/js.cookie.min.js"></script>
    <style>
        .bd-placeholder-img {
            font-size: 1.125rem;
            text-anchor: middle;
            -webkit-user-select: none;
            -moz-user-select: none;
            user-select: none;
        }

        @media (min-width: 768px) {
            .bd-placeholder-img-lg {
                font-size: 3.5rem;
            }
        }

        .b-example-divider {
            width: 100%;
            height: 3rem;
            background-color: rgba(0, 0, 0, .1);
            border: solid rgba(0, 0, 0, .15);
            border-width: 1px 0;
            box-shadow: inset 0 .5em 1.5em rgba(0, 0, 0, .1), inset 0 .125em .5em rgba(0, 0, 0, .15);
        }

        .b-example-vr {
            flex-shrink: 0;
            width: 1.5rem;
            height: 100vh;
        }

        .bi {
            vertical-align: -.125em;
            fill: currentColor;
        }

        .nav-scroller {
            position: relative;
            z-index: 2;
            height: 2.75rem;
            overflow-y: hidden;
        }

        .nav-scroller .nav {
            display: flex;
            flex-wrap: nowrap;
            padding-bottom: 1rem;
            margin-top: -1px;
            overflow-x: auto;
            text-align: center;
            white-space: nowrap;
            -webkit-overflow-scrolling: touch;
        }

        .btn-bd-primary {
            --bd-violet-bg: #712cf9;
            --bd-violet-rgb: 112.520718, 44.062154, 249.437846;

            --bs-btn-font-weight: 600;
            --bs-btn-color: var(--bs-white);
            --bs-btn-bg: var(--bd-violet-bg);
            --bs-btn-border-color: var(--bd-violet-bg);
            --bs-btn-hover-color: var(--bs-white);
            --bs-btn-hover-bg: #6528e0;
            --bs-btn-hover-border-color: #6528e0;
            --bs-btn-focus-shadow-rgb: var(--bd-violet-rgb);
            --bs-btn-active-color: var(--bs-btn-hover-color);
            --bs-btn-active-bg: #5a23c8;
            --bs-btn-active-border-color: #5a23c8;
        }

        .bd-mode-toggle {
            z-index: 1500;
        }

        .align-items-right > p {
            margin: 0px 10px;
            font-size: 18px;
            cursor: pointer;
        }

        .align-items-right > p:hover {
            font-weight: bold;
            cursor: pointer;
        }

        #nologinmain {
            margin: 0;
            padding: 0;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .heading {
            margin: 0;
            padding: 0;
            font-size: 14rem;
            line-height: 14rem;
            color: transparent;
            -webkit-text-stroke-width: 2px;
            -webkit-text-stroke-color: black;
            height: 14rem;
            margin-top: calc(100vh / 2 - 7rem);
            position: absolute;
            top: 0;
        }

        .heading:first-child {
            color: black;
        }

        .heading {
            transition: transform .3s;
        }

        .frame {
            position: absolute;
            top: 80vh;
            width: 50%;
        }

        .button {
            padding: 1em 1.5em;
            font-size: 1em;
            font-weight: 400;
            font-family: "Helvetica", "Arial", sans-serif;
            border-radius: 4px;
            cursor: pointer;
            appearance: none;
            border: none;
            color: #ffffff;
            margin-bottom: 20px;
        }

        .button-second {
            background: linear-gradient(to right, #1488cc, #2b32b2);
            box-shadow: 0 2px 25px rgba(20, 137, 204, 0.5);
        }

        .button-second:active {
            background: linear-gradient(
                    to right,
                    rgba(20, 136, 204, 0.9),
                    rgba(43, 50, 178, 0.9)
            );
        }

        .button:focus {
            outline: none;
        }

        particle {
            left: 0;
            top: 0;
            pointer-events: none;
            position: fixed;
            opacity: 0;
        }

        .center {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            display: flex;
            flex-direction: column;
        }

    </style>
</head>

<body>
<header data-bs-theme="dark">
    <div class="navbar navbar-dark bg-dark shadow-sm">
        <div class="container">
            <a class="navbar-brand d-flex align-items-center" href="#">
                <strong>Ha-rmony</strong>
            </a>

            <a class="navbar-brand d-flex align-items-right">
                <p id="login" onclick="login()">ë¡œê·¸ì¸</p>
                <p id="mypage" onclick="mypage()">ë§ˆì´í˜ì´ì§€</p>
                <p id="logout" onclick="logout()">ë¡œê·¸ì•„ì›ƒ</p>
            </a>
        </div>
    </div>
</header>

<main id="nologinmain">
    <h1 class="heading">í•˜-ã„¹ëª¨ë‹ˆ</h1>
    <h1 class="heading">í•˜-ã„¹ëª¨ë‹ˆ</h1>
    <h1 class="heading">í•˜-ã„¹ëª¨ë‹ˆ</h1>
    <h1 class="heading">í•˜-ã„¹ëª¨ë‹ˆ</h1>
    <h1 class="heading">í•˜-ã„¹ëª¨ë‹ˆ</h1>

    <div class="frame">
        <div class="center">
            <button class="button button-second" data-type="circle">ë¡œê·¸ì¸ / íšŒì›ê°€ì…</button>
        </div>
    </div>

    <script>
        if (document.body.animate) {
            document
                .querySelectorAll(".button")
                .forEach((button) => button.addEventListener("click", pop));
        }

        function pop(e) {
            for (let i = 0; i < 30; i++) {
                createParticle(e.clientX, e.clientY, e.target.dataset.type);
            }
        }

        function createParticle(x, y, type) {
            const particle = document.createElement("particle");
            document.body.appendChild(particle);

            const size = Math.floor(Math.random() * 20 + 5);

            particle.style.width = `${size}px`;
            particle.style.height = `${size}px`;

            const destinationX = x + (Math.random() - 0.5) * 2 * 75;
            const destinationY = y + (Math.random() - 0.5) * 2 * 75;

            switch (type) {
                case "circle":
                    particle.style.background = `hsl(${Math.random() * 90 + 180}, 70%, 60%)`;
                    particle.style.borderRadius = "50%";
                    break;
                default:
                    particle.style.background = `hsl(${Math.random() * 90 + 180}, 70%, 60%)`;
            }

            const animation = particle.animate(
                [
                    {
                        // Set the origin position of the particle
                        // We offset the particle with half its size to center it around the mouse
                        transform: `translate(${x - size / 2}px, ${y - size / 2}px)`,
                        opacity: 1,
                    },
                    {
                        // We define the final coordinates as the second keyframe
                        transform: `translate(${destinationX}px, ${destinationY}px)`,
                        opacity: 0,
                    },
                ],
                {
                    duration: 500 + Math.random() * 1000,
                    easing: "cubic-bezier(0, .9, .57, 1)",
                    delay: Math.random() * 200,
                }
            );

            animation.onfinish = () => {
                particle.removeParticle;
                window.location.href = "http://localhost:8080/api/users/login-page";
            };
        }

        function removeParticle(e) {
            e.srcElement.effect.target.remove();
        }

    </script>
</main>

<main id="main">
    <section class="py-5 text-center container">
        <div class="row py-lg-5">
            <div class="col-lg-6 col-md-8 mx-auto">
                <h1 class="fw-light">[[${user}]] 's workspace</h1>
            </div>
        </div>
    </section>

    <div class="album py-5 bg-body-tertiary">
        <div class="container">
            <div class="d-flex justify-content-end" style="margin-bottom: 20px;">
                <!-- Button trigger modal -->
                <button class="btn btn-secondary" data-bs-target="#exampleModal" data-bs-toggle="modal"
                        type="button">
                    Add Board
                </button>

                <form class="upload__form" enctype="multipart/form-data" id="uploadForm">
                    <!-- Modal -->
                    <div aria-hidden="true" aria-labelledby="exampleModalLabel" class="modal fade" id="exampleModal"
                         tabindex="-1">
                        <div class="modal-dialog">
                            <div class="modal-content">
                                <div class="modal-header">
                                    <h1 class="modal-title fs-5" id="exampleModalLabel">Create board</h1>
                                    <button aria-label="Close" class="btn-close" data-bs-dismiss="modal"
                                            type="button"></button>
                                </div>
                                <div class="modal-body text-start">
                                    <div class="mb-3">
                                        <label class="form-label" for="formGroupExampleInput">Board Title</label>
                                        <input class="form-control" id="formGroupExampleInput"
                                               placeholder="ğŸ‘‹ Board title is required" type="text">
                                    </div>
                                    <label class="form-label" for="exampleColorInput">Background</label>
                                    <input class="form-control form-control-color" id="exampleColorInput"
                                           title="Choose your color" type="color" value="#563d7c">
                                </div>
                                <div class="modal-footer">
                                    <button class="btn btn-secondary" data-bs-dismiss="modal" type="button">Close
                                    </button>
                                    <button class="btn btn-primary" type="submit">Start with a template</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </form>
            </div>
            <div style="margin-bottom: 20px;">
                <text style="font-size: 25px;">My Board</text>
            </div>
            <div class="row row-cols-1 row-cols-sm-2 row-cols-md-3 g-3">
                <!--Board ë¶€ë¶„-->
                <div class="col" th:each="board : ${boardList}" th:id="${board.getBoardId()}">
                    <input th:id="'board'+${board.getBoardId()}" type="hidden">
                    <div class="card shadow-sm">
                        <a class="card-svg-link" style="cursor: pointer;"
                           th:href="'/api/boards/'+${board.getBoardId()}">
                            <svg aria-label="Placeholder: Thumbnail" class="bd-placeholder-img card-img-top"
                                 focusable="false" height="225" preserveAspectRatio="xMidYMid slice" role="img"
                                 width="100%" xmlns="http://www.w3.org/2000/svg">
                                <title>Placeholder</title>
                                <rect height="100%" th:fill="${board.getBoardColor()}" width="100%"></rect>
                                <text class="boardTitleText" dy=".3em" x="50%" y="50%">
                                    [[${board.getBoardTitle()}]]
                                </text>
                            </svg>
                        </a>
                        <div class="card text-end">
                            <div class="card-body">
                                <button class="btn btn-sm btn-outline-secondary"
                                        data-bs-toggle="modal"
                                        th:data-bs-target="'#staticBackdrop'+${board.getBoardId()}"
                                        type="button">Delete
                                </button>
                                <!-- Modal -->
                                <div aria-hidden="true" aria-labelledby="staticBackdropLabel"
                                     class="modal fade"
                                     data-bs-backdrop="static" data-bs-keyboard="false"
                                     tabindex="-1"
                                     th:id="'staticBackdrop'+${board.getBoardId()}">
                                    <div class="modal-dialog">
                                        <div class="modal-content">
                                            <div class="modal-header">
                                                <h1 class="modal-title fs-5" id="staticBackdropLabel">
                                                    [[${board.getBoardTitle}]]</h1>
                                                <button aria-label="Close" class="btn-close" data-bs-dismiss="modal"
                                                        type="button"></button>
                                            </div>
                                            <div class="model-body">
                                                ì •ë§ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?
                                            </div>
                                            <div class="modal-footer">
                                                <button class="btn btn-secondary" data-bs-dismiss="modal" type="button">
                                                    Close
                                                </button>
                                                <button class="btn btn-primary"
                                                        th:onclick="'deleteBoard('+${board.getBoardId()}+')'"
                                                        type="button">Delete Board
                                                </button>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <button class="btn btn-sm btn-outline-secondary editBoards"
                                        data-bs-toggle="modal"
                                        th:data-bs-target="'#staticBackdropEdit'+${board.getBoardId()}"
                                        type="button">Edit
                                </button>
                                <input class="findEditBoardId" th:value="${board.getBoardId()}" type="hidden">
                                <form class="edit__form" enctype="multipart/form-data"
                                      th:id="'editForm'+${board.getBoardId()}">
                                    <!-- Modal -->
                                    <div aria-hidden="true" aria-labelledby="staticBackdropEditLabel" class="modal fade"
                                         data-bs-backdrop="static"
                                         data-bs-keyboard="false" tabindex="-1"
                                         th:id="'staticBackdropEdit'+${board.getBoardId()}">
                                        <div class="modal-dialog">
                                            <div class="modal-content">
                                                <div class="modal-header">
                                                    <h1 class="modal-title fs-5" id="staticBackdropEditLabel"
                                                        th:value="${board.getBoardTitle()}">
                                                        [[${board.getBoardTitle()}]]</h1>
                                                    <button aria-label="Close" class="btn-close" data-bs-dismiss="modal"
                                                            type="button"></button>
                                                </div>
                                                <div class="modal-body text-start">
                                                    <div class="mb-3">
                                                        <label class="form-label" for="formGroupExampleInputEdit">Board
                                                            Title</label>
                                                        <input class="form-control" id="formGroupExampleInputEdit"
                                                               placeholder="ğŸ‘‹ Board title is required"
                                                               th:value="${board.getBoardTitle()}"
                                                               type="text">
                                                    </div>
                                                    <label class="form-label"
                                                           for="exampleColorInputEdit">Background</label>
                                                    <input class="form-control form-control-color"
                                                           id="exampleColorInputEdit"
                                                           th:value="${board.getBoardColor()}" title="Choose your color"
                                                           type="color">
                                                    <br>
                                                    <div class="mb-3">
                                                        <label class="form-label" for="formGroupExampleInputDescEdit">Board
                                                            Description</label>
                                                        <input class="form-control" id="formGroupExampleInputDescEdit"
                                                               placeholder="ğŸ‘‹ Description your Board"
                                                               th:value="${board.getBoardDesc()}"
                                                               type="text">
                                                    </div>
                                                </div>
                                                <div class="modal-footer">
                                                    <button class="btn btn-secondary" data-bs-dismiss="modal"
                                                            type="button">
                                                        Close
                                                    </button>
                                                    <button class="btn btn-primary"
                                                            type="submit">Edit
                                                        Board
                                                    </button>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </form>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <br>
            <br>
        </div>
    </div>
    <script th:inline="javascript">
        /*<![CDATA[*/
        const boardColors = [
            /*[# th:each="board : ${boardList}"]*/
            [[${board.getBoardColor()}]],
            /*[/]*/
        ];
        /*]]>*/
    </script>
    <script>
        $(document).ready(function () {
            $(".boardTitleText").each(function (index) {
                const boardColor = boardColors[index];
                const textColor = getBrightness(boardColor);
                $(this).attr("fill", textColor);
            });
        });
    </script>
    <script>
        // ë°°ê²½ìƒ‰ì˜ ë°ê¸° ê³„ì‚° í•¨ìˆ˜
        function getBrightness(hexColor) {
            console.log("getBrightness ë“¤ì–´ì˜´" + hexColor);
            const c = hexColor.substring(1)      // ìƒ‰ìƒ ì•ì˜ # ì œê±°
            const rgb = parseInt(c, 16)   // rrggbbë¥¼ 10ì§„ìˆ˜ë¡œ ë³€í™˜
            const r = (rgb >> 16) & 0xff  // red ì¶”ì¶œ
            const g = (rgb >> 8) & 0xff  // green ì¶”ì¶œ
            const b = (rgb >> 0) & 0xff  // blue ì¶”ì¶œ
            const luma = 0.2126 * r + 0.7152 * g + 0.0722 * b // per ITU-R BT.709
            // ìƒ‰ìƒ ì„ íƒ
            return luma < 127.5 ? "#FFFFFF" : "#000000" // ê¸€ììƒ‰ì´
        }

        // ë³´ë“œ ì¶”ê°€ì‹œ í˜ì´ì§€ ë¡œë”© ì—†ì´ ì¶”ê°€ì‹œì¼œì£¼ê¸° ìœ„í•¨
        function addNewBoard(boardId, boardTitle, boardColor) {
            const textColor = getBrightness(boardColor);
            const newBoardHtml =
                `
                    <div class="col" id="${boardId}">
                      <input id="board+${boardId}" type="hidden">
                      <div class="card shadow-sm">
                        <a class="card-svg-link" href="/api/boards/${boardId}" style="cursor: pointer;">
                          <svg aria-label="Placeholder: Thumbnail" class="bd-placeholder-img card-img-top" focusable="false" height="225"
                            preserveAspectRatio="xMidYMid slice" role="img" width="100%" xmlns="http://www.w3.org/2000/svg">
                            <title>Placeholder</title>
                            <rect fill="${boardColor}" height="100%" width="100%"></rect>
                            <text class="boardTitleText" dy=".3em" fill="${textColor}" x="50%" y="50%">${boardTitle}</text>
                          </svg>
                        </a>
                        <div class="card text-end">
                          <div class="card-body">
                            <button class="btn btn-sm btn-outline-secondary" type="button" data-bs-toggle="modal"
                              data-bs-target="#staticBackdrop${boardId}">Delete</button>
                            <!-- Modal -->
                            <div aria-hidden="true" aria-labelledby="staticBackdropLabel" class="modal fade" data-bs-backdrop="static"
                              data-bs-keyboard="false" tabindex="-1" id="staticBackdrop${boardId}">
                              <div class="modal-dialog">
                                <div class="modal-content">
                                  <div class="modal-header">
                                    <h1 class="modal-title fs-5" id="staticBackdropLabel">
                                      ${boardTitle}</h1>
                                    <button aria-label="Close" class="btn-close" data-bs-dismiss="modal" type="button"></button>
                                  </div>
                                  <div class="model-body">
                                    ì •ë§ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?
                                  </div>
                                  <div class="modal-footer">
                                    <button class="btn btn-secondary" data-bs-dismiss="modal" type="button">
                                      Close
                                    </button>
                                    <button class="btn btn-primary" onclick="deleteBoard(${boardId})" type="button">Delete Board
                                    </button>
                                  </div>
                                </div>
                              </div>
                            </div>

                            <button class="btn btn-sm btn-outline-secondary editBoards" data-bs-toggle="modal"
                              data-bs-target="#staticBackdropEdit${boardId}" type="button">Edit
                            </button>
                            <input type="hidden" class="findEditBoardId" value="${boardId}">
                                <form class="edit__form" enctype="multipart/form-data"
                                      id="editForm${boardId}">
                                <!-- Modal -->
                                <div aria-hidden="true" aria-labelledby="staticBackdropEditLabel" class="modal fade" data-bs-backdrop="static"
                              data-bs-keyboard="false" id="staticBackdropEdit${boardId}" tabindex="-1">
                              <div class="modal-dialog">
                                <div class="modal-content">
                                  <div class="modal-header">
                                    <h1 class="modal-title fs-5" id="staticBackdropEditLabel" value="${boardTitle}">${boardTitle}</h1>
                                    <button aria-label="Close" class="btn-close" data-bs-dismiss="modal" type="button"></button>
                                  </div>
                                  <div class="modal-body text-start">
                                    <div class="mb-3">
                                      <label class="form-label" for="formGroupExampleInputEdit">Board
                                        Title</label>
                                      <input class="form-control" id="formGroupExampleInputEdit" placeholder="ğŸ‘‹ Board title is required"
                                        type="text" value="${boardTitle}">
                                    </div>
                                    <label class="form-label" for="exampleColorInputEdit">Background</label>
                                    <input class="form-control form-control-color" id="exampleColorInputEdit" value="${boardColor}"
                                      title="Choose your color" type="color">
                                    <br>
                                    <div class="mb-3">
                                      <label class="form-label" for="formGroupExampleInputDescEdit">Board
                                        Description</label>
                                      <input class="form-control" id="formGroupExampleInputDescEdit" placeholder="ğŸ‘‹ Description your Board"
                                        type="text">
                                    </div>
                                  </div>
                                  <div class="modal-footer">
                                    <button class="btn btn-secondary" data-bs-dismiss="modal" type="button">
                                      Close
                                    </button>
                                    <button class="btn btn-primary" type="submit">Edit Board</button>
                                  </div>
                                </div>
                              </div>
                            </div>
                            </form>
                          </div>
                        </div>
                      </div>
                    </div>
                `;
            $('.row-cols-1.row-cols-sm-2.row-cols-md-3.g-3').append(newBoardHtml);
            console.log("ì¶”ê°€");
        }


        function updateBoard(boardId) {
            console.log(boardId + "update");
            const title = $('#staticBackdropEdit' + boardId + ' #formGroupExampleInputEdit').val();
            const color = $('#staticBackdropEdit' + boardId + ' #exampleColorInputEdit').val();
            const desc = $('#staticBackdropEdit' + boardId + ' #formGroupExampleInputDescEdit').val();

            $.ajax({
                type: "PATCH",
                url: "/api/boards/" + boardId,
                contentType: "application/json",
                data: JSON.stringify({
                    boardTitle: title,
                    boardColor: color,
                    boardDesc: desc
                }),
                success: function (data) {
                    console.log(data);
                    const successMessage = $('<div class="alert alert-success">edit successful!</div>');

                    $('#staticBackdropEdit' + boardId + ' .modal-body').append(successMessage);

                    // ìˆ˜ì •ëœ ë‚´ìš©ìœ¼ë¡œ í™”ë©´ ì—…ë°ì´íŠ¸
                    updateBoardOnScreen(boardId, title, color, desc);
                },
                error: function (xhr, status, error) {
                    console.error(error);
                    alert('Upload failed or an error occurred');
                }
            });

        }

        $(document).ready(function () {
            // ë™ì ìœ¼ë¡œ ì¶”ê°€ëœ ìš”ì†Œì— ëŒ€í•œ ì´ë²¤íŠ¸ ìœ„ì„
            $(document).on('click', '.editBoards', function () {
                const boardId = $(this).siblings('.findEditBoardId').val();
                const editFormId = '#editForm' + boardId;
                const editForm = $(editFormId);
                console.log("$(document).on('click', '.editBoards', function () { : " + boardId);

                // "ìˆ˜ì •" ë²„íŠ¼ í´ë¦­ ì‹œì—ë§Œ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆë¥¼ ì¶”ê°€í•˜ë„ë¡ ì„¤ì •
                editForm.on('submit', function (e) {
                    e.preventDefault();
                    console.log("e.preventDefault(); " + boardId);
                    updateBoard(boardId);
                });

                // "ìˆ˜ì •" í¼ ë‹«í ë•Œ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ í•´ì œ
                $('#staticBackdropEdit' + boardId).on('hidden.bs.modal', function () {
                    editForm.off('submit');
                });
            });

            // "Add Board" ëª¨ë‹¬ í¼ ì œì¶œ ì‹œ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì¶”ê°€
            $('#uploadForm').on('submit', function (event) {
                event.preventDefault();

                const title = $('#formGroupExampleInput').val();
                const color = $('#exampleColorInput').val();

                $.ajax({
                    url: '/api/boards',
                    type: 'POST',
                    contentType: "application/json",
                    data: JSON.stringify({
                        boardTitle: title,
                        boardColor: color
                    }),
                    success: function (data) {
                        console.log(data);
                        const successMessage = $('<div class="alert alert-success">create successful!</div>');

                        $('#exampleModal .modal-body').append(successMessage);

                        // ìƒˆë¡œìš´ ë³´ë“œë¥¼ í™”ë©´ì— ì¶”ê°€í•˜ëŠ” í•¨ìˆ˜ í˜¸ì¶œ
                        addNewBoard(data.boardId, title, color);

                        setTimeout(function () {
                            $('#exampleModal').modal('hide');
                            successMessage.remove();
                        }, 1000);
                    },
                    error: function (xhr, status, error) {
                        console.error(error);
                        alert('Upload failed or an error occurred');
                    }
                });
            });
        });

        function deleteBoard(boardId) {
            $.ajax({
                type: "DELETE",
                url: "/api/boards/" + boardId,
                contentType: "application/json",
                success: function (data) {
                    console.log(data);
                    // ëª¨ë‹¬ ë‹«ê¸°
                    $('#staticBackdrop' + boardId).modal('hide');
                    // ì‚­ì œí•œ ë³´ë“œì˜ ìš”ì†Œ ì œê±°
                    $('#' + boardId).remove();

                    const successMessage = $('<div class="alert alert-success">delete successful!</div>');
                    $('#staticBackdrop' + boardId + ' .modal-footer').append(successMessage);

                    setTimeout(function () {
                        successMessage.remove();
                    }, 1000);
                },
                error: function (xhr, status, error) {
                    console.error(error);
                    alert('Upload failed or an error occurred');
                }
            })
        }

        // ìˆ˜ì •ëœ ë‚´ìš©ìœ¼ë¡œ í™”ë©´ ì—…ë°ì´íŠ¸ í•¨ìˆ˜
        function updateBoardOnScreen(boardId, title, color, desc) {
            const successMessageSelector = `#staticBackdropEdit${boardId} .alert-success`;
            $(successMessageSelector).remove(); // ì´ì „ì˜ successMessage ì—˜ë¦¬ë¨¼íŠ¸ ì œê±°

            const successMessage = $('<div class="alert alert-success">ìˆ˜ì • ì„±ê³µ!</div>');
            $('#staticBackdropEdit' + boardId + ' .modal-body').append(successMessage);

            const editedBoard = $('#' + boardId);
            editedBoard.find('.boardTitleText').text(title);
            editedBoard.find('rect').attr('fill', color);
            editedBoard.find('text').attr('fill', getBrightness(color));
            editedBoard.find('h1').text(title);

            setTimeout(function () {
                $('#staticBackdropEdit' + boardId).modal('hide');
                successMessage.remove();
            }, 1000);
        }
    </script>
</main>
</body>
<script>
    const headings = document.querySelectorAll('.heading');
    let firstRun = true;

    window.addEventListener('scroll', () => {
        const scrollValue = window.scrollY;

        headings.forEach((heading, index) => {
            heading.style.top = `${scrollValue * .07 * index}px`;
            if (firstRun) {
                heading.style.transform = `translateY(0px)`;
            }
        });

        firstRun = false;
    });

    setTimeout(function () {
        headings.forEach((heading, index) => {
            heading.style.transform = `translateY(${index * 8}px)`;
        });
    }, 500);

    buttonOnOff();

    function mypage() {
        window.location.href = 'http://localhost:8080/api/users/mypage';
    }

    function login() {
        window.location.href = 'http://localhost:8080/api/users/login-page';
    }

    function logout() {
        deleteJwtCookie();
        window.location.reload();
    }

    function deleteJwtCookie() {
        const cookieName = 'Authorization'; // JWTê°€ ì €ì¥ëœ ì¿ í‚¤ì˜ ì´ë¦„
        // ë§Œë£Œì¼ì„ ì˜ˆì „ ë‚ ì§œë¡œ ì„¤ì •í•˜ì—¬ ì¿ í‚¤ë¥¼ ì‚­ì œí•©ë‹ˆë‹¤.
        document.cookie = `${cookieName}=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/;`;
    }

    function buttonOnOff() {
        const loginButton = document.getElementById('login'); // ë¡œê·¸ì¸ ë²„íŠ¼ ìš”ì†Œë¥¼ ê°€ì ¸ì˜´
        const logoutButton = document.getElementById('logout'); // ë¡œê·¸ì•„ì›ƒ ë²„íŠ¼ ìš”ì†Œë¥¼ ê°€ì ¸ì˜´
        const mypageButton = document.getElementById('mypage'); // ë§ˆì´í˜ì´ì§€ ë²„íŠ¼ ìš”ì†Œë¥¼ ê°€ì ¸ì˜´

        const mainElement = document.getElementById('main');
        const nomainElement = document.getElementById('nologinmain');

        const jwtToken = getJwtFromCookie(); // Request í—¤ë”ì—ì„œ JWT í† í°ì„ ê°€ì ¸ì˜´

        if (jwtToken) {
            mainElement.style.display = 'block';
            nomainElement.style.display = 'none';
            loginButton.style.display = 'none';
            logoutButton.style.display = 'inline';
            mypageButton.style.display = 'inline';
        } else {
            mainElement.style.display = 'none';
            nomainElement.style.display = 'flex';
            loginButton.style.display = 'inline';
            logoutButton.style.display = 'none';
            mypageButton.style.display = 'none';
        }
    }

    function getJwtFromCookie() {
        const cookieName = 'Authorization'; // JWTê°€ ì €ì¥ëœ ì¿ í‚¤ì˜ ì´ë¦„
        const cookies = document.cookie.split(';');

        for (let i = 0; i < cookies.length; i++) {
            const cookie = cookies[i].trim();

            if (cookie.startsWith(`${cookieName}=`)) {
                const jwtCookie = cookie.substring(cookieName.length + 1);
                return jwtCookie;
            }
        }

        return null; // JWTê°€ ì¡´ì¬í•˜ì§€ ì•ŠëŠ” ê²½ìš° null ë°˜í™˜
    }
</script>
</html>